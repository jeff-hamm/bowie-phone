[platformio]
default_envs = esp32dev
[env:esp32dev]
platform = espressif32
board = esp32dev
framework = arduino
board_build.partitions = huge_app.csv
monitor_speed = 115200
monitor_filters = esp32_exception_decoder
build_flags =
#  -DAUDIOKIT_BOARD=5
#  -DCORE_DEBUG_LEVEL=0
  -Os
#  -ffunction-sections
#  -fdata-sections
#  -Wl,--gc-sections
#  -DARDUINO_LOOP_STACK_SIZE=8192
  -DBOARD_HAS_PSRAM
  -mfix-esp32-psram-cache-issue
#  -DDISABLE_ALL_LIBRARY_WARNINGS
#  -DARDUINO_SERIAL_EVENT_TASK_STACK_SIZE=4096
#  -DARDUINO_SERIAL_EVENT_TASK_PRIORITY=1
#  -Wno-unused-variable
#  -Wno-unused-but-set-variable
#  -Wno-unused-function
#  -Wno-format-extra-args
#  -w
  ; WiFi Configuration - Change these values as needed
  -DWIFI_AP_NAME=\"Bowie-Phone-Setup\"
  -DWIFI_AP_PASSWORD=\"bowie123\"
  -DWIFI_PORTAL_TIMEOUT=180
  ; Firmware Version - Increment this to force cache reset on next upload
  -DFIRMWARE_VERSION=\"1.0.0\"
  ; OTA Configuration - Change these values as needed
  -DOTA_HOSTNAME=\"bowiephone\"
  -DOTA_PASSWORD=\"bowie-ota-2024\"
  -DOTA_PORT=3232
  ; Known Sequences Configuration
  ; -DKNOWN_SEQUENCES_URL=\"https://your-server.com/api/sequences\"
  ; -DSD_CS_PIN=5  ; SD card chip select pin (adjust for your board)
  ; Audio Input Device Configuration (uncomment one or use default ADC_INPUT_ALL)
  ; -DAUDIO_INPUT_DEVICE=ADC_INPUT_LINE1  ; Microphone only
  -DAUDIO_INPUT_DEVICE=ADC_INPUT_LINE2  ; Line in only  
  ; -DAUDIO_INPUT_DEVICE=ADC_INPUT_LINE3  ; Right mic + left line in
  ; -DAUDIO_INPUT_DEVICE=ADC_INPUT_ALL    ; Both microphone and line in (default)
  ; Custom Command Configuration (uncomment and modify as needed)
  ; -DCUSTOM_COMMAND_1_SEQ=\"*111#\" -DCUSTOM_COMMAND_1_DESC=\"Custom Status\"
  ; -DCUSTOM_COMMAND_2_SEQ=\"*222#\" -DCUSTOM_COMMAND_2_DESC=\"Custom Reset\"
  ; -DCUSTOM_COMMAND_3_SEQ=\"*333#\" -DCUSTOM_COMMAND_3_DESC=\"Custom Test\"
  ; -DCUSTOM_COMMAND_4_SEQ=\"*444#\" -DCUSTOM_COMMAND_4_DESC=\"Custom Debug\"
  ; -DCUSTOM_COMMAND_5_SEQ=\"#111*\" -DCUSTOM_COMMAND_5_DESC=\"Custom Mode\"
  ; -DCUSTOM_COMMAND_6_SEQ=\"#222*\" -DCUSTOM_COMMAND_6_DESC=\"Custom Audio\"
  ; -DCUSTOM_COMMAND_7_SEQ=\"*#11#\" -DCUSTOM_COMMAND_7_DESC=\"Custom Info\"
  ; -DCUSTOM_COMMAND_8_SEQ=\"*#22#\" -DCUSTOM_COMMAND_8_DESC=\"Custom Admin\"
  ; Tailscale/WireGuard VPN Configuration
  ; Generate keys: wg genkey | tee privatekey | wg pubkey > publickey
  -DWIREGUARD_PRIVATE_KEY=\"oKQVt6GM4zlNEKvHZFoX6R5VCy4f32VRg1+4I9Rf6Ug=\"
  -DWIREGUARD_PEER_PUBLIC_KEY=\"RHIzwk9dreElESrlN+AOxqXKZLChSjm6SItJMvUOTEg=\"
  -DWIREGUARD_PEER_ENDPOINT=\"jumprouter.infinitebutts.com\"
  -DWIREGUARD_PEER_PORT=41641
  -DWIREGUARD_LOCAL_IP=\"10.253.0.2\"  ; Your Tailscale IP
lib_deps =
  https://github.com/pschatzmann/arduino-audio-driver.git
  https://github.com/pschatzmann/arduino-audio-tools.git
  https://github.com/pschatzmann/arduino-audiokit.git
  https://github.com/pschatzmann/arduino-libhelix.git
  https://github.com/ciniml/WireGuard-ESP32-Arduino.git
  ArduinoOTA
  bblanchon/ArduinoJson@^7.0.4
upload_port = COM3
monitor_port = COM3
[env:ota]
extends = env:esp32dev
upload_protocol = espota
upload_port = bowie-phone.local
upload_flags =
  --port=3232
  --auth=bowie-ota-2024
